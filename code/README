This pipeline for processing BAM files for a set of DMS Map-seq experiments
into files of per-region or per-transcript mismatch rates and summary statistics
is implemented in 8 sequential steps, the last of which can be repeated to
interrogate different elements of the transcriptome.

Each step of the pipeline should successfully run to completion before beginning
the subsequent step.

The steps are:
 # The most computationally demanding step, where base mismatch rates calculated
 # transcriptome-wide separately for each chromosome and each sample.  Results
 # are reported in *.pileup files.
./GWSA1.sh

# Bases are retained after this step only if they pass a filter on depth,
# which can be set within the shell script.  Output is in bedGraph format.
./GWSA2.sh

# Mismatch rates from DMS-treated samples are "normalized" using non-DMS-treated
# controls.
./GWSA3.sh

# The per-chromosome, per-sample files from the preceding steps are combined
# into a single per-sample file.
./GWSA4.sh

# This step of the pipeline, together with the following step, ensures that sites
# in the transcriptome are retained for further analysis only if they exhibit
# adequate coverage (i.e. above the specified threshold) for ALL samples/conditions.
./GWSA5.sh

# Together with the previous step, ensure consistently high coverage among
# regions that are to be compared across conditions.
./GWSA6.sh

# An optional step to assess the per-sample distribution of normalized mismatch
# rates.  These distributions can be used to set a upper bound for a per-sample
# (as opposed to per-transcript or per-region) Winsorization.
./GWSA7.sh

# For now only "canonical" transcripts are considered (i.e. a single annotation
# per transcript) .All of the steps below calculate and report summary statistics
# for different elements of the transcriptome:
./GWSA8_3utr.sh # 3' UTRs.
./GWSA8_5utr.sh # 5' UTRs.
./GWSA8_cds_assemble.sh # Spliced coding sequences (i.e. excluding UTRs)
./GWSA8_cds_unspliced.sh # Individual exons (unspliced CDS, UTRs excluded)
./GWSA8_transcript_assemble.sh # Complete spliced transcripts, including UTRs.
